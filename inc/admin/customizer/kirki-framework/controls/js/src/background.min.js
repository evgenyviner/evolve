wp.customize.controlConstructor["kirki-background"]=wp.customize.Control.extend({ready:function(){var a=this;if(!_.isUndefined(window.kirkiControlLoader)&&_.isFunction(kirkiControlLoader)){kirkiControlLoader(a)}else{a.initKirkiControl()}},initKirkiControl:function(){var c=this,b=c.setting._value,a=c.container.find(".kirki-color-control");if(_.isUndefined(b["background-image"])||""===b["background-image"]){c.container.find(".background-wrapper > .background-repeat").hide();c.container.find(".background-wrapper > .background-position").hide();c.container.find(".background-wrapper > .background-size").hide();c.container.find(".background-wrapper > .background-attachment").hide()}a.wpColorPicker({change:function(){setTimeout(function(){c.saveValue("background-color",a.val())},100)}});c.container.on("change",".background-repeat select",function(){c.saveValue("background-repeat",jQuery(this).val())});c.container.on("change click",".background-size input",function(){c.saveValue("background-size",jQuery(this).val())});c.container.on("change",".background-position select",function(){c.saveValue("background-position",jQuery(this).val())});c.container.on("change click",".background-attachment input",function(){c.saveValue("background-attachment",jQuery(this).val())});c.container.on("click",".background-image-upload-button",function(f){var d=wp.media({multiple:false}).open().on("select",function(){var h=d.state().get("selection").first(),l=h.toJSON().sizes.full.url,j,i,g,e,m,k;if(!_.isUndefined(h.toJSON().sizes.medium)){l=h.toJSON().sizes.medium.url}else{if(!_.isUndefined(h.toJSON().sizes.thumbnail)){l=h.toJSON().sizes.thumbnail.url}}j=h.toJSON().sizes.full.url;i=h.toJSON().id;g=h.toJSON().width;e=h.toJSON().height;if(""!==j){c.container.find(".background-wrapper > .background-repeat, .background-wrapper > .background-position, .background-wrapper > .background-size, .background-wrapper > .background-attachment").show()}c.saveValue("background-image",j);m=c.container.find(".placeholder, .thumbnail");k=c.container.find(".background-image-upload-remove-button");if(m.length){m.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+l+'" alt="" />')}if(k.length){k.show()}});f.preventDefault()});c.container.on("click",".background-image-upload-remove-button",function(g){var f,d;g.preventDefault();c.saveValue("background-image","");f=c.container.find(".placeholder, .thumbnail");d=c.container.find(".background-image-upload-remove-button");c.container.find(".background-wrapper > .background-repeat").hide();c.container.find(".background-wrapper > .background-position").hide();c.container.find(".background-wrapper > .background-size").hide();c.container.find(".background-wrapper > .background-attachment").hide();if(f.length){f.removeClass().addClass("placeholder").html("No file selected")}if(d.length){d.hide()}})},saveValue:function(c,b){var d=this,a=jQuery("#customize-control-"+d.id.replace("[","-").replace("]","")+" .background-hidden-value"),e=d.setting._value;e[c]=b;jQuery(a).attr("value",JSON.stringify(e)).trigger("change");d.setting.set(e)}});