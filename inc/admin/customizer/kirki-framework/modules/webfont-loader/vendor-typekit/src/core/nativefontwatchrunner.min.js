goog.provide("webfont.NativeFontWatchRunner");goog.require("webfont.Font");goog.scope(function(){webfont.NativeFontWatchRunner=function(c,e,g,d,b,f){this.activeCallback_=c;this.inactiveCallback_=e;this.font_=d;this.domHelper_=g;this.timeout_=b||3000;this.fontTestString_=f||undefined};var a=webfont.NativeFontWatchRunner;a.prototype.start=function(){var d=this.domHelper_.getLoadWindow().document,c=this;var g=goog.now();var b=new Promise(function(j,i){var h=function(){var k=goog.now();if(k-g>=c.timeout_){i()}else{d.fonts.load(c.font_.toCssString(),c.fontTestString_).then(function(l){if(l.length>=1){j()}else{setTimeout(h,25)}},function(){i()})}};h()});var e=null,f=new Promise(function(i,h){e=setTimeout(h,c.timeout_)});Promise.race([f,b]).then(function(){if(e){clearTimeout(e);e=null}c.activeCallback_(c.font_)},function(){c.inactiveCallback_(c.font_)})}});