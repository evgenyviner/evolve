goog.provide("webfont.WebFont");goog.require("webfont.DomHelper");goog.require("webfont.EventDispatcher");goog.require("webfont.FontWatcher");goog.require("webfont.FontModuleLoader");webfont.WebFont=function(a){this.mainWindow_=a;this.fontModuleLoader_=new webfont.FontModuleLoader();this.moduleLoading_=0;this.events_=true;this.classes_=true};goog.scope(function(){var d=webfont.WebFont,a=webfont.DomHelper,b=webfont.EventDispatcher,c=webfont.FontWatcher;d.prototype.addModule=function(f,e){this.fontModuleLoader_.addModuleFactory(f,e)};d.prototype.load=function(g){var f=g.context||this.mainWindow_;this.domHelper_=new a(this.mainWindow_,f);this.events_=g.events!==false;this.classes_=g.classes!==false;var e=new b(this.domHelper_,g);this.load_(e,g)};d.prototype.onModuleReady_=function(f,i,j,g,h){var e=--this.moduleLoading_==0;if(this.classes_||this.events_){setTimeout(function(){i.watchFonts(j,g||null,h||null,e)},0)}};d.prototype.load_=function(m,f){var h=[],l=f.timeout,n=this;m.dispatchLoading();h=this.fontModuleLoader_.getModules(f,this.domHelper_);var g=new webfont.FontWatcher(this.domHelper_,m,l);this.moduleLoading_=h.length;for(var j=0,k=h.length;j<k;j++){var e=h[j];e.load(function(p,i,o){n.onModuleReady_(m,g,p,i,o)})}}});