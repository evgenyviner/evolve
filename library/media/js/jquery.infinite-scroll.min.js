!function(t){"use strict";var e=-1,i=function(i,n){return this.itemsContainerSelector=n.container,this.itemSelector=n.item,this.nextSelector=n.next,this.paginationSelector=n.pagination,this.$scrollContainer=i,this.$container=window===i.get(0)?t(document):i,this.defaultDelay=n.delay,this.negativeMargin=n.negativeMargin,this.nextUrl=null,this.isBound=!1,this.isPaused=!1,this.listeners={next:new IASCallbacks,load:new IASCallbacks,loaded:new IASCallbacks,render:new IASCallbacks,rendered:new IASCallbacks,scroll:new IASCallbacks,noneLeft:new IASCallbacks,ready:new IASCallbacks},this.extensions=[],this.scrollHandler=function(){if(this.isBound&&!this.isPaused){var t=this.getCurrentScrollOffset(this.$scrollContainer),i=this.getScrollThreshold();e!=i&&(this.fire("scroll",[t,i]),t>=i&&this.next())}},this.getItemsContainer=function(){return t(this.itemsContainerSelector)},this.getLastItem=function(){return t(this.itemSelector,this.getItemsContainer().get(0)).last()},this.getFirstItem=function(){return t(this.itemSelector,this.getItemsContainer().get(0)).first()},this.getScrollThreshold=function(t){var i;return t=t||this.negativeMargin,t=t>=0?-1*t:t,i=this.getLastItem(),0===i.length?e:i.offset().top+i.height()+t},this.getCurrentScrollOffset=function(t){var e=0,i=t.height();return e=window===t.get(0)?t.scrollTop():t.offset().top,(-1!=navigator.platform.indexOf("iPhone")||-1!=navigator.platform.indexOf("iPod"))&&(i+=80),e+i},this.getNextUrl=function(e){return e=e||this.$container,t(this.nextSelector,e).last().attr("href")},this.load=function(e,i,n){var s,r,o=this,a=[],h=+new Date;n=n||this.defaultDelay;var l={url:e};return o.fire("load",[l]),t.get(l.url,null,t.proxy(function(e){s=t(this.itemsContainerSelector,e).eq(0),0===s.length&&(s=t(e).filter(this.itemsContainerSelector).eq(0)),s&&s.find(this.itemSelector).each(function(){a.push(this)}),o.fire("loaded",[e,a]),i&&(r=+new Date-h,n>r?setTimeout(function(){i.call(o,e,a)},n-r):i.call(o,e,a))},o),"html")},this.render=function(e,i){var n=this,s=this.getLastItem(),r=0,o=this.fire("render",[e]);o.done(function(){t(e).hide(),s.after(e),t(e).fadeIn(400,function(){++r<e.length||(n.fire("rendered",[e]),i&&i())})})},this.hidePagination=function(){this.paginationSelector&&t(this.paginationSelector,this.$container).hide()},this.restorePagination=function(){this.paginationSelector&&t(this.paginationSelector,this.$container).show()},this.throttle=function(e,i){var n,s,r=0;return n=function(){function t(){r=+new Date,e.apply(n,o)}var n=this,o=arguments,a=+new Date-r;s?clearTimeout(s):t(),a>i?t():s=setTimeout(t,i)},t.guid&&(n.guid=e.guid=e.guid||t.guid++),n},this.fire=function(t,e){return this.listeners[t].fireWith(this,e)},this.pause=function(){this.isPaused=!0},this.resume=function(){this.isPaused=!1},this};i.prototype.initialize=function(){var t=!!("onscroll"in this.$scrollContainer.get(0)),e=this.getCurrentScrollOffset(this.$scrollContainer),i=this.getScrollThreshold();return t?(this.hidePagination(),this.bind(),this.fire("ready"),this.nextUrl=this.getNextUrl(),e>=i&&this.next(),this):!1},i.prototype.reinitialize=function(){this.unbind(),this.initialize()},i.prototype.bind=function(){if(!this.isBound){this.$scrollContainer.on("scroll",t.proxy(this.throttle(this.scrollHandler,150),this));for(var e=0,i=this.extensions.length;i>e;e++)this.extensions[e].bind(this);this.isBound=!0,this.resume()}},i.prototype.unbind=function(){if(this.isBound){this.$scrollContainer.off("scroll",this.scrollHandler);for(var t=0,e=this.extensions.length;e>t;t++)"undefined"!=typeof this.extensions[t].unbind&&this.extensions[t].unbind(this);this.isBound=!1}},i.prototype.destroy=function(){this.unbind(),this.$scrollContainer.data("ias",null)},i.prototype.on=function(e,i,n){if("undefined"==typeof this.listeners[e])throw new Error('There is no event called "'+e+'"');return n=n||0,this.listeners[e].add(t.proxy(i,this),n),this},i.prototype.one=function(t,e){var i=this,n=function(){i.off(t,e),i.off(t,n)};return this.on(t,e),this.on(t,n),this},i.prototype.off=function(t,e){if("undefined"==typeof this.listeners[t])throw new Error('There is no event called "'+t+'"');return this.listeners[t].remove(e),this},i.prototype.next=function(){var t=this.nextUrl,e=this;if(this.pause(),!t)return this.fire("noneLeft",[this.getLastItem()]),this.listeners.noneLeft.disable(),e.resume(),!1;var i=this.fire("next",[t]);return i.done(function(){e.load(t,function(t,i){e.render(i,function(){e.nextUrl=e.getNextUrl(t),e.resume()})})}),i.fail(function(){e.resume()}),!0},i.prototype.extension=function(t){if("undefined"==typeof t.bind)throw new Error('Extension doesn\'t have required method "bind"');return"undefined"!=typeof t.initialize&&t.initialize(this),this.extensions.push(t),this.reinitialize(),this},t.ias=function(e){var i=t(window);return i.ias.apply(i,arguments)},t.fn.ias=function(e){var n=Array.prototype.slice.call(arguments),s=this;return this.each(function(){var r=t(this),o=r.data("ias"),a=t.extend({},t.fn.ias.defaults,r.data(),"object"==typeof e&&e);if(o||(r.data("ias",o=new i(r,a)),t(document).ready(t.proxy(o.initialize,o))),"string"==typeof e){if("function"!=typeof o[e])throw new Error('There is no method called "'+e+'"');n.shift(),o[e].apply(o,n)}s=o}),s},t.fn.ias.defaults={item:".item",container:".listing",next:".next",pagination:!1,delay:600,negativeMargin:10}}(jQuery);